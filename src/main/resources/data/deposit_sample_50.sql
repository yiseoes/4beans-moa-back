INSERT INTO DEPOSIT (
    PARTY_ID,
    PARTY_MEMBER_ID,
    USER_ID,
    DEPOSIT_TYPE,
    DEPOSIT_AMOUNT,
    DEPOSIT_STATUS,
    PAYMENT_DATE,
    REFUND_DATE,
    REFUND_AMOUNT,
    TOSS_PAYMENT_KEY,
    ORDER_ID
)
SELECT
    pm.PARTY_ID,
    pm.PARTY_MEMBER_ID,
    pm.USER_ID,

    CASE
        WHEN pm.MEMBER_ROLE = 'LEADER' THEN 'LEADER'
        ELSE 'SECURITY'
    END AS DEPOSIT_TYPE,

    CASE
        WHEN pm.MEMBER_ROLE = 'LEADER' THEN 20000
        ELSE 5000
    END AS DEPOSIT_AMOUNT,

    CASE
        WHEN pm.PARTY_MEMBER_ID % 4 = 0 THEN 'REFUNDED'
        WHEN pm.PARTY_MEMBER_ID % 4 = 1 THEN 'PAID'
        WHEN pm.PARTY_MEMBER_ID % 4 = 2 THEN 'PARTIAL_REFUNDED'
        ELSE 'PENDING'
    END AS DEPOSIT_STATUS,

    DATE_ADD(p.REG_DATE, INTERVAL 5 DAY) AS PAYMENT_DATE,

    CASE
        WHEN pm.PARTY_MEMBER_ID % 4 IN (0,2)
        THEN DATE_ADD(p.REG_DATE, INTERVAL 30 DAY)
    END AS REFUND_DATE,

    CASE
        WHEN pm.PARTY_MEMBER_ID % 4 = 0 THEN
            CASE WHEN pm.MEMBER_ROLE = 'LEADER' THEN 20000 ELSE 5000 END
        WHEN pm.PARTY_MEMBER_ID % 4 = 2 THEN
            CASE WHEN pm.MEMBER_ROLE = 'LEADER' THEN 10000 ELSE 2500 END
    END AS REFUND_AMOUNT,

    CONCAT('toss_dep_', LPAD(pm.PARTY_MEMBER_ID, 4, '0')) AS TOSS_PAYMENT_KEY,
    CONCAT('ORD_DEP_', LPAD(pm.PARTY_MEMBER_ID, 4, '0')) AS ORDER_ID

FROM PARTY_MEMBER pm
JOIN PARTY p
  ON p.PARTY_ID = pm.PARTY_ID
WHERE pm.PARTY_ID BETWEEN 6 AND 55
LIMIT 50;
